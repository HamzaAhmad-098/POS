# app/views/products/index.html.erb
<div class="container">
  <div class="header">
    <h1>Products</h1>
    <div class="actions">
      <%= link_to "Add Product", new_product_path, class: "btn btn-primary" %>
      <%= link_to "Bulk Import", bulk_import_products_path, class: "btn btn-secondary" %>
      <%= link_to "Scan Barcode", scan_products_path, class: "btn btn-info" %>
    </div>
  </div>

  <div class="search-section">
    <%= form_with url: products_path, method: :get, local: true do |form| %>
      <div class="search-box">
        <%= form.text_field :search, placeholder: "Search by name or barcode...", value: params[:search] %>
        <%= form.submit "Search", class: "btn btn-search" %>
      </div>
    <% end %>
    
    <div class="filters">
      <%= link_to "All Products", products_path, class: "filter-btn #{'active' unless params[:low_stock]}" %>
      <%= link_to "Low Stock", products_path(low_stock: true), class: "filter-btn #{'active' if params[:low_stock]}" %>
    </div>
  </div>

  <div class="products-table">
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Barcode</th>
          <th>Category</th>
          <th>Price</th>
          <th>Stock</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @products.each do |product| %>
          <tr class="<%= 'low-stock' if product.current_stock <= product.reorder_level %>">
            <td>
              <% if product.photo.attached? %>
                <%= image_tag product.photo, class: "product-thumb" %>
              <% end %>
              <%= product.name %>
            </td>
            <td><%= product.barcode %></td>
            <td><%= product.category&.name %></td>
            <td>Rs. <%= product.selling_price %></td>
            <td>
              <span class="stock <%= 'danger' if product.current_stock <= product.reorder_level %>">
                <%= product.current_stock %>
              </span>
            </td>
            <td class="actions">
              <%= link_to "Edit", edit_product_path(product), class: "btn btn-sm" %>
              <%= link_to "Delete", product_path(product), 
                          method: :delete, 
                          data: { confirm: "Are you sure?" }, 
                          class: "btn btn-sm btn-danger" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    
    <% if @products.empty? %>
      <div class="empty-state">
        <p>No products found.</p>
        <%= link_to "Add Your First Product", new_product_path, class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>